#!/usr/bin/env python3

import pandas as pd
import numpy as np
import math

def buildMatrix():

    # read mash results and create array
    df = pd.read_csv('mash.txt', header=None, sep='\t')
    iniArray = df.to_numpy()

    # calculate number of fastas, and use to split iniArray and create mash matrix
    numFastas = math.sqrt(len(iniArray))    
    colList = np.split(iniArray[:,2], numFastas)   
    mashMatrix = np.vstack(colList)
    
    # find average distance of each row
    sumArray = mashMatrix.sum(axis=1)
    avArray = sumArray/numFastas

    # find filenames and append to average distance
    filenames = iniArray[0:int(numFastas), 0]
    fileavArray = np.column_stack((filenames, avArray))

    return fileavArray

if __name__ == "__main__":

    fileavArray = buildMatrix()
